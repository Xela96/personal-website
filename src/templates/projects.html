{% extends 'base.html' %}
{% block content %}

<div class="topnav">
    <input type="text" placeholder="Search.." onkeyup="liveSearch(this.value)">
</div>
<div id="results"></div>
<div class="container">
    <h1>My Projects</h1>
    <ul>
        {% for project in projects %}
            <li>
                <h2>{{ project.title }}</h2>
                <p>{{ project.description }}</p>
                <p><strong>Technologies Used:</strong> {{ project.technologies }}</p>
            </li>
        {% endfor %}
    </ul>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
function liveSearch(value) {
    value = value.trim();

    if (value != "") {
        $(".container ul").hide();
            $.ajax({
                url: "/projects",
                data: { searchText: value },
                dataType: 'json',
                headers: { "X-Requested-With": "XMLHttpRequest" }, // <-- Add this line
                success: function(data) {
                    var res = "";
                    for(result in data.results) {
                        res += "<div>" + data.results[result] + "</div>";
                    }
                    $("#results").html(res);
                }
            })
    }
    else {
        $("#results").html("");
        $(".container ul").show();
    }
}
</script>

{% endblock %}